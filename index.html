<!DOCTYPE html>
<html>
<head>
    <title>Broad COVID-19 Testing Dashboard</title>
    <link rel="icon" type="image/x-icon" href="static/favicon.ico">
    <meta name="description" content="Statistics on COVID-19 testing at the Broad Institute of MIT and Harvard in Cambridge, MA, USA.">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
   
    <meta http-equiv="refresh" content="600">
    <style type="text/css">
        body, wrapper {
            min-height: 100vh;
        }

        nav {
            background-color: #FAFBFC;
            border-bottom: 1px solid rgba(72, 94, 144, 0.16);
        }

        .card-title {
            text-transform: uppercase;
            font-size: 14px;
            letter-spacing: 0.5px;
            color: #1b2e4b;
            font-weight: 600;
        }

        .card-main-info {
            color: rgb(33, 37, 41);
            display: inline-block;
            font-size: 28px;
            font-weight: 500;
            margin: 0px 8px 8px 0px;
            text-align: left;
            /* min-width: 85px; */
        }

        .card-main-info-samples-from {
            color: rgb(33, 37, 41);
            display: inline-block;
            font-size: 20px;
            font-weight: 500;
            margin: 0px 5px 8px 0px;
            text-align:left;
            /* min-width:65px; */
        }

        .card-secondary-info {
            color: rgb(33, 37, 41);
            display: inline-block;
            font-size: 15px;
            font-weight: 500;
            text-align:left;
        }

        .card-small-text {
            color: rgb(33, 37, 41);
            display: inline-block;
            font-size: 13px;
            font-weight: 500;
            text-align:left;
        }

        footer {
            border-top: 1px solid rgba(72, 94, 144, 0.16);
            background-color: #FAFBFC;
        }

        .section-title {
            font-size: 22px;
            font-weight: bolder;
            font-weight: 500;
        }

        @media (min-width: 1400px) {
            .no-padding-right-in-large-screens {
                padding-right:0px !important;
            }
            .col-xl-3-and-a-half {
                width: 28%;
                flex: 0 0 28%;
                max-width: 28%;
            }
            .col-xl-8-and-a-half {
                width: 72%;
                flex: 0 0 72%;
                max-width: 72%;
            }
        }

        @media only screen and (max-width: 1400px) {
            .expands-in-small-screens {
                flex: 0 0 100% !important;
                max-width: 100% !important;
            }
            .hide-in-small-screen {
                display: none;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-161539452-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'UA-161539452-1');
    </script>
</head>
<body>
    <wrapper class="d-flex flex-column">
        <nav class="navbar navbar-default navbar-static-top">
            <div class="container">
                <div class="row flex-fill">
                    <div class="col-sm-3 text-center">
                        <a class="navbar-brand" href="https://www.broadinstitute.org/" style="margin: 3px 10px 3px 0px">
                            <img src="static/BroadInstLogoforDigitalRGB.png" width="170" height="43" />
                        </a>
                    </div>
                    <div class="col-sm-12 col-lg-9 text-center" style="align-self: center; font-size: 27px; font-family: sans-serif; font-weight: 300">
                        COVID-19 Diagnostic Processing Dashboard
                    </div>
                </div>
            </div>
        </nav>
        <div class="content content-fixed flex-fill">
            <div class="container">
                <div class="row">
                    <div class="col-lg-0 col-sm-0"></div>
                    <div class="col-sm-12 col-lg-12 mt-4 mb-5 expands-in-small-screens">
                        In late March 2020, Broad Institute <a href="https://www.broadinstitute.org/news/how-broad-institute-converted-clinical-processing-lab-large-scale-covid-19-testing-facility">rapidly converted our large-scale genomics facility</a> into a center that can process SARS-CoV-2 tests. Working in partnership with the Commonwealth of Massachusetts, Massachusetts State Public Health Laboratory, and medical facilities in the Commonwealth, the Broad's CLIA-certified lab processes samples collected from patients in Massachusetts and beyond.<br />
                        <br />
                        This page shows the number of SARS-CoV-2 viral diagnostic tests processed at the Clinical Research Sequencing Platform (CRSP) at the Broad Institute of MIT and Harvard.<br />
                        <br />
                        These numbers are updated during the course of the day as samples are completed at Broad. For details on the testing program, visit the <a href="https://www.broadinstitute.org/covid-19-testing">Broad Institute website</a>.<br/>
                    </div>
                </div>
                <div class="row">
                    <div class="col-lg-3 col-xl-3-and-a-half expands-in-small-screens no-padding-right-in-large-screens" style="padding-bottom: 2rem;">
                        <div class="card card-body mt-2" style="background-color: #FFFFFF">
                            <h6 class="card-title">
                                <span style="color:#439798">Total</span> Tests Completed
                            </h6>
                            <div style="white-space: nowrap">
                                <h3 class="card-main-info" style="color:#439798">6,519,677</h3>
                                <span class="card-secondary-info"> since 3/25/2020</span>
                            </div>
                        </div>
                        <div class="card card-body mt-2" style="background-color: #FFFFFF">
                            <h6 class="card-title">
                                <span style="color:#e18b50">Positive </span>Tests
                            </h6>
                            <div style="white-space: nowrap">
                                <h3 class="card-main-info" style="color:#e18b50">102,109</h3>
                                <div><span class="card-main-info">2%</span> of tests</div>
                                <div><span  id="rolling-ave" class="card-main-info"></span><span class="card-small-text"> last 7-day rolling average</span></div>

                            </div>
                        </div>
                        <!--  div class="card card-body mt-2" style="background-color: #FFFFFF">
                            <h6 class="card-title">
                                <span style="color:black">Tested </span>
                                <span style="color:#00AA00">Negative </span>
                            </h6>
                            <div style="white-space: nowrap">
                                <h3 class="card-main-info"></h3>
                                <span class="card-secondary-info"></span>
                            </div>
                        </div -->
                        <div class="card card-body mt-2" style="background-color: #FFFFFF">
                            <h7 class="card-title">
                              <span style="color: gray;">Inconclusive &amp; Invalid </span>Tests
                              <a target="_blank" href="https://covid-19-test-info.broadinstitute.org/#unsatisfactory-tnp-test-not-performed-result-code-information" style="padding-left: 1px; text-decoration: none; color: #AAAAAA">
                                    <i class="fa fa-question-circle-o" target="_blank"></i>
                                </a>
                            </h7>
                            <div style="white-space: nowrap">
                              <h3 class="card-main-info" style="color: gray;">26,363</h3>
                              <div><span class="card-main-info">0.4%</span> of tests</div>
                            </div>
                        </div>
                        <div class="card card-body mt-2" style="background-color: #FFFFFF; display: none;">
                            <h7 class="card-title">
                                Tests by Region
                            </h7>
                            <div style="white-space: nowrap">
                                <h3 class="card-main-info-samples-from">6,377,372</h3>
                                <span class="card-secondary-info" style="color:gray"> from MA </span>
                                <span class="card-secondary-info">(98%)</span>
                                <br />
                                <h3 class="card-main-info-samples-from">142,305</h3>
                                <span class="card-secondary-info" style="color:gray"> from out of state </span>
                                <span class="card-secondary-info">(2%)</span>
                            </div>
                        </div>
                    </div><!-- col -->
                    <div class="col-lg-12 col-xl-8-and-a-half mt-2">
                        <div class="btn-group btn-group-sm" role="group" aria-label="time scales" style="width: 100%; padding-bottom: 2rem;">
                          <button type="button" class="btn btn-outline-secondary">1W</button>
                          <button type="button" class="btn btn-outline-secondary">1M</button>
                          <button type="button" class="btn btn-outline-secondary active">3M</button>
                          <button type="button" class="btn btn-outline-secondary">6M</button>
                          <button type="button" class="btn btn-outline-secondary">All</button>
                        </div>
                        <div>
                            <figure class="highcharts-figure">
                                <div id="chart-1"></div>
                            </figure>
                            <figure class="highcharts-figure">
                                <div id="chart-2"></div>
                            </figure>
                            <figure class="highcharts-figure">
                                <div id="chart-3"></div>
                            </figure>
                        </div>
                        <div class="text-secondary mt-5" style="margin:50px 10px">
                            The numbers will not match the daily reports from the State of Massachusetts for several reasons:
                            <ul>
                                <li>Some people are tested more than once (for example, as a confirmation or re-test, or as part of an ongoing college/university testing program). The figures here reflect the number of tests performed, not the number of people tested.</li>
                                <li>Broad Institute processes some tests from other states.</li>
                            </ul>
                            The "percent positive" pertains to the tests submitted to Broad. Because different organizations use different criteria for selecting individuals for testing, it is not possible to draw meaningful conclusions about infection rates or trends from these data. <br />
                            <br />
                            The Clinical Research Sequencing Platform, LLC is a subsidiary of the Broad Institute.<br />

                        </div>
                    </div>
                </div><!-- row -->
            </div><!-- container -->
        </div>

        <footer>
            <div class="container text-right" style="padding:10px">
                <span style="font-size: 15px; padding-right: 20px">
                    <a href="mailto:genomics@broadinstitute.org" style="text-decoration:none; font-weight:500">
                        <span style="padding-left: 10px">Contact Us</span>
                        <i class="fa fa-envelope" aria-hidden="true" style="padding-left: 35px"></i>
                    </a>
                    <a target="_blank" href="https://twitter.com/broadinstitute" style="text-decoration: none; margin-left: 7px">
                        <i class="fa fa-twitter" aria-hidden="true"></i>
                    </a>
                    <a target="_blank" href="https://github.com/broadinstitute/covid19-testing/issues" style="text-decoration: none; margin-left: 7px">
                        <i class="fa fa-github" aria-hidden="true"></i>
                    </a>
                </span>
            </div>
        </footer>

    </wrapper>
</body>
<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/exporting.js"></script>
<script src="https://code.highcharts.com/modules/export-data.js"></script>
<script src="https://code.highcharts.com/modules/accessibility.js"></script>
<script src="https://code.highcharts.com/modules/pattern-fill.js"></script>
<script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>

<script>
  //docs @ https://api.highcharts.com/highcharts/
  let data = [{"day": "2020-03-25", "inconclusive": 0, "negative": 123, "positive": 17, "shortDate": "3/25"}, {"day": "2020-03-26", "inconclusive": 3, "negative": 138, "positive": 57, "shortDate": "3/26"}, {"day": "2020-03-27", "inconclusive": 0, "negative": 94, "positive": 27, "shortDate": "3/27"}, {"day": "2020-03-28", "inconclusive": 1, "negative": 195, "positive": 51, "shortDate": "3/28"}, {"day": "2020-03-29", "inconclusive": 5, "negative": 127, "positive": 41, "shortDate": "3/29"}, {"day": "2020-03-30", "inconclusive": 1, "negative": 213, "positive": 32, "shortDate": "3/30"}, {"day": "2020-03-31", "inconclusive": 4, "negative": 275, "positive": 87, "shortDate": "3/31"}, {"day": "2020-04-01", "inconclusive": 2, "negative": 598, "positive": 108, "shortDate": "4/1"}, {"day": "2020-04-02", "inconclusive": 7, "negative": 539, "positive": 157, "shortDate": "4/2"}, {"day": "2020-04-03", "inconclusive": 9, "negative": 678, "positive": 185, "shortDate": "4/3"}, {"day": "2020-04-04", "inconclusive": 6, "negative": 1076, "positive": 272, "shortDate": "4/4"}, {"day": "2020-04-05", "inconclusive": 7, "negative": 723, "positive": 272, "shortDate": "4/5"}, {"day": "2020-04-06", "inconclusive": 9, "negative": 700, "positive": 341, "shortDate": "4/6"}, {"day": "2020-04-07", "inconclusive": 11, "negative": 710, "positive": 329, "shortDate": "4/7"}, {"day": "2020-04-08", "inconclusive": 8, "negative": 563, "positive": 415, "shortDate": "4/8"}, {"day": "2020-04-09", "inconclusive": 11, "negative": 1470, "positive": 485, "shortDate": "4/9"}, {"day": "2020-04-10", "inconclusive": 10, "negative": 1421, "positive": 535, "shortDate": "4/10"}, {"day": "2020-04-11", "inconclusive": 9, "negative": 1531, "positive": 377, "shortDate": "4/11"}, {"day": "2020-04-12", "inconclusive": 13, "negative": 623, "positive": 309, "shortDate": "4/12"}, {"day": "2020-04-13", "inconclusive": 8, "negative": 854, "positive": 407, "shortDate": "4/13"}, {"day": "2020-04-14", "inconclusive": 8, "negative": 852, "positive": 312, "shortDate": "4/14"}, {"day": "2020-04-15", "inconclusive": 21, "negative": 1222, "positive": 586, "shortDate": "4/15"}, {"day": "2020-04-16", "inconclusive": 15, "negative": 2138, "positive": 610, "shortDate": "4/16"}, {"day": "2020-04-17", "inconclusive": 24, "negative": 2206, "positive": 667, "shortDate": "4/17"}, {"day": "2020-04-18", "inconclusive": 18, "negative": 2764, "positive": 846, "shortDate": "4/18"}, {"day": "2020-04-19", "inconclusive": 25, "negative": 1210, "positive": 394, "shortDate": "4/19"}, {"day": "2020-04-20", "inconclusive": 37, "negative": 1942, "positive": 571, "shortDate": "4/20"}, {"day": "2020-04-21", "inconclusive": 32, "negative": 2482, "positive": 676, "shortDate": "4/21"}, {"day": "2020-04-22", "inconclusive": 34, "negative": 2053, "positive": 446, "shortDate": "4/22"}, {"day": "2020-04-23", "inconclusive": 38, "negative": 2008, "positive": 548, "shortDate": "4/23"}, {"day": "2020-04-24", "inconclusive": 37, "negative": 2904, "positive": 526, "shortDate": "4/24"}, {"day": "2020-04-25", "inconclusive": 53, "negative": 2666, "positive": 439, "shortDate": "4/25"}, {"day": "2020-04-26", "inconclusive": 15, "negative": 1740, "positive": 353, "shortDate": "4/26"}, {"day": "2020-04-27", "inconclusive": 20, "negative": 2947, "positive": 399, "shortDate": "4/27"}, {"day": "2020-04-28", "inconclusive": 16, "negative": 2307, "positive": 417, "shortDate": "4/28"}, {"day": "2020-04-29", "inconclusive": 25, "negative": 2614, "positive": 467, "shortDate": "4/29"}, {"day": "2020-04-30", "inconclusive": 20, "negative": 2070, "positive": 418, "shortDate": "4/30"}, {"day": "2020-05-01", "inconclusive": 52, "negative": 3871, "positive": 513, "shortDate": "5/1"}, {"day": "2020-05-02", "inconclusive": 52, "negative": 3428, "positive": 496, "shortDate": "5/2"}, {"day": "2020-05-03", "inconclusive": 32, "negative": 2252, "positive": 180, "shortDate": "5/3"}, {"day": "2020-05-04", "inconclusive": 13, "negative": 1369, "positive": 278, "shortDate": "5/4"}, {"day": "2020-05-05", "inconclusive": 45, "negative": 2933, "positive": 440, "shortDate": "5/5"}, {"day": "2020-05-06", "inconclusive": 60, "negative": 3280, "positive": 359, "shortDate": "5/6"}, {"day": "2020-05-07", "inconclusive": 51, "negative": 3356, "positive": 384, "shortDate": "5/7"}, {"day": "2020-05-08", "inconclusive": 26, "negative": 2557, "positive": 324, "shortDate": "5/8"}, {"day": "2020-05-09", "inconclusive": 20, "negative": 3074, "positive": 279, "shortDate": "5/9"}, {"day": "2020-05-10", "inconclusive": 10, "negative": 709, "positive": 84, "shortDate": "5/10"}, {"day": "2020-05-11", "inconclusive": 6, "negative": 473, "positive": 56, "shortDate": "5/11"}, {"day": "2020-05-12", "inconclusive": 37, "negative": 2843, "positive": 299, "shortDate": "5/12"}, {"day": "2020-05-13", "inconclusive": 39, "negative": 2583, "positive": 273, "shortDate": "5/13"}, {"day": "2020-05-14", "inconclusive": 31, "negative": 2895, "positive": 188, "shortDate": "5/14"}, {"day": "2020-05-15", "inconclusive": 31, "negative": 3170, "positive": 326, "shortDate": "5/15"}, {"day": "2020-05-16", "inconclusive": 46, "negative": 4896, "positive": 154, "shortDate": "5/16"}, {"day": "2020-05-17", "inconclusive": 20, "negative": 3604, "positive": 128, "shortDate": "5/17"}, {"day": "2020-05-18", "inconclusive": 8, "negative": 995, "positive": 88, "shortDate": "5/18"}, {"day": "2020-05-19", "inconclusive": 25, "negative": 3833, "positive": 233, "shortDate": "5/19"}, {"day": "2020-05-20", "inconclusive": 32, "negative": 2822, "positive": 131, "shortDate": "5/20"}, {"day": "2020-05-21", "inconclusive": 24, "negative": 3553, "positive": 145, "shortDate": "5/21"}, {"day": "2020-05-22", "inconclusive": 32, "negative": 3829, "positive": 197, "shortDate": "5/22"}, {"day": "2020-05-23", "inconclusive": 27, "negative": 3014, "positive": 127, "shortDate": "5/23"}, {"day": "2020-05-24", "inconclusive": 7, "negative": 1736, "positive": 66, "shortDate": "5/24"}, {"day": "2020-05-25", "inconclusive": 2, "negative": 687, "positive": 42, "shortDate": "5/25"}, {"day": "2020-05-26", "inconclusive": 26, "negative": 2455, "positive": 54, "shortDate": "5/26"}, {"day": "2020-05-27", "inconclusive": 8, "negative": 2900, "positive": 110, "shortDate": "5/27"}, {"day": "2020-05-28", "inconclusive": 15, "negative": 3843, "positive": 154, "shortDate": "5/28"}, {"day": "2020-05-29", "inconclusive": 16, "negative": 2909, "positive": 141, "shortDate": "5/29"}, {"day": "2020-05-30", "inconclusive": 36, "negative": 1707, "positive": 58, "shortDate": "5/30"}, {"day": "2020-05-31", "inconclusive": 6, "negative": 1777, "positive": 45, "shortDate": "5/31"}, {"day": "2020-06-01", "inconclusive": 3, "negative": 334, "positive": 5, "shortDate": "6/1"}, {"day": "2020-06-02", "inconclusive": 4, "negative": 2610, "positive": 121, "shortDate": "6/2"}, {"day": "2020-06-03", "inconclusive": 13, "negative": 2917, "positive": 66, "shortDate": "6/3"}, {"day": "2020-06-04", "inconclusive": 10, "negative": 2037, "positive": 59, "shortDate": "6/4"}, {"day": "2020-06-05", "inconclusive": 5, "negative": 3653, "positive": 61, "shortDate": "6/5"}, {"day": "2020-06-06", "inconclusive": 31, "negative": 2980, "positive": 102, "shortDate": "6/6"}, {"day": "2020-06-07", "inconclusive": 2, "negative": 1154, "positive": 33, "shortDate": "6/7"}, {"day": "2020-06-08", "inconclusive": 3, "negative": 725, "positive": 12, "shortDate": "6/8"}, {"day": "2020-06-09", "inconclusive": 11, "negative": 3126, "positive": 54, "shortDate": "6/9"}, {"day": "2020-06-10", "inconclusive": 13, "negative": 4671, "positive": 91, "shortDate": "6/10"}, {"day": "2020-06-11", "inconclusive": 12, "negative": 4166, "positive": 55, "shortDate": "6/11"}, {"day": "2020-06-12", "inconclusive": 16, "negative": 4423, "positive": 55, "shortDate": "6/12"}, {"day": "2020-06-13", "inconclusive": 17, "negative": 2690, "positive": 39, "shortDate": "6/13"}, {"day": "2020-06-14", "inconclusive": 16, "negative": 1157, "positive": 20, "shortDate": "6/14"}, {"day": "2020-06-15", "inconclusive": 25, "negative": 1569, "positive": 17, "shortDate": "6/15"}, {"day": "2020-06-16", "inconclusive": 7, "negative": 3177, "positive": 30, "shortDate": "6/16"}, {"day": "2020-06-17", "inconclusive": 58, "negative": 4130, "positive": 40, "shortDate": "6/17"}, {"day": "2020-06-18", "inconclusive": 17, "negative": 2387, "positive": 22, "shortDate": "6/18"}, {"day": "2020-06-19", "inconclusive": 14, "negative": 2499, "positive": 35, "shortDate": "6/19"}, {"day": "2020-06-20", "inconclusive": 13, "negative": 3591, "positive": 23, "shortDate": "6/20"}, {"day": "2020-06-21", "inconclusive": 70, "negative": 3029, "positive": 35, "shortDate": "6/21"}, {"day": "2020-06-22", "inconclusive": 21, "negative": 1790, "positive": 20, "shortDate": "6/22"}, {"day": "2020-06-23", "inconclusive": 12, "negative": 2172, "positive": 25, "shortDate": "6/23"}, {"day": "2020-06-24", "inconclusive": 15, "negative": 2978, "positive": 84, "shortDate": "6/24"}, {"day": "2020-06-25", "inconclusive": 17, "negative": 3075, "positive": 69, "shortDate": "6/25"}, {"day": "2020-06-26", "inconclusive": 12, "negative": 4097, "positive": 80, "shortDate": "6/26"}, {"day": "2020-06-27", "inconclusive": 24, "negative": 3337, "positive": 85, "shortDate": "6/27"}, {"day": "2020-06-28", "inconclusive": 58, "negative": 3729, "positive": 66, "shortDate": "6/28"}, {"day": "2020-06-29", "inconclusive": 15, "negative": 1938, "positive": 97, "shortDate": "6/29"}, {"day": "2020-06-30", "inconclusive": 29, "negative": 4527, "positive": 71, "shortDate": "6/30"}, {"day": "2020-07-01", "inconclusive": 10, "negative": 2713, "positive": 76, "shortDate": "7/1"}, {"day": "2020-07-02", "inconclusive": 29, "negative": 4458, "positive": 221, "shortDate": "7/2"}, {"day": "2020-07-03", "inconclusive": 58, "negative": 4934, "positive": 96, "shortDate": "7/3"}, {"day": "2020-07-04", "inconclusive": 15, "negative": 1024, "positive": 48, "shortDate": "7/4"}, {"day": "2020-07-05", "inconclusive": 34, "negative": 3511, "positive": 233, "shortDate": "7/5"}, {"day": "2020-07-06", "inconclusive": 39, "negative": 1590, "positive": 95, "shortDate": "7/6"}, {"day": "2020-07-07", "inconclusive": 12, "negative": 1159, "positive": 35, "shortDate": "7/7"}, {"day": "2020-07-08", "inconclusive": 24, "negative": 6479, "positive": 92, "shortDate": "7/8"}, {"day": "2020-07-09", "inconclusive": 41, "negative": 4157, "positive": 73, "shortDate": "7/9"}, {"day": "2020-07-10", "inconclusive": 65, "negative": 5126, "positive": 170, "shortDate": "7/10"}, {"day": "2020-07-11", "inconclusive": 66, "negative": 4591, "positive": 119, "shortDate": "7/11"}, {"day": "2020-07-12", "inconclusive": 80, "negative": 5721, "positive": 214, "shortDate": "7/12"}, {"day": "2020-07-13", "inconclusive": 41, "negative": 3386, "positive": 178, "shortDate": "7/13"}, {"day": "2020-07-14", "inconclusive": 37, "negative": 6501, "positive": 254, "shortDate": "7/14"}, {"day": "2020-07-15", "inconclusive": 36, "negative": 6298, "positive": 144, "shortDate": "7/15"}, {"day": "2020-07-16", "inconclusive": 52, "negative": 6559, "positive": 144, "shortDate": "7/16"}, {"day": "2020-07-17", "inconclusive": 30, "negative": 6128, "positive": 105, "shortDate": "7/17"}, {"day": "2020-07-18", "inconclusive": 42, "negative": 7666, "positive": 214, "shortDate": "7/18"}, {"day": "2020-07-19", "inconclusive": 26, "negative": 6337, "positive": 173, "shortDate": "7/19"}, {"day": "2020-07-20", "inconclusive": 10, "negative": 4860, "positive": 187, "shortDate": "7/20"}, {"day": "2020-07-21", "inconclusive": 25, "negative": 5737, "positive": 173, "shortDate": "7/21"}, {"day": "2020-07-22", "inconclusive": 11, "negative": 6275, "positive": 249, "shortDate": "7/22"}, {"day": "2020-07-23", "inconclusive": 31, "negative": 7957, "positive": 233, "shortDate": "7/23"}, {"day": "2020-07-24", "inconclusive": 59, "negative": 7711, "positive": 233, "shortDate": "7/24"}, {"day": "2020-07-25", "inconclusive": 55, "negative": 8168, "positive": 288, "shortDate": "7/25"}, {"day": "2020-07-26", "inconclusive": 32, "negative": 8029, "positive": 356, "shortDate": "7/26"}, {"day": "2020-07-27", "inconclusive": 50, "negative": 6477, "positive": 232, "shortDate": "7/27"}, {"day": "2020-07-28", "inconclusive": 32, "negative": 7752, "positive": 314, "shortDate": "7/28"}, {"day": "2020-07-29", "inconclusive": 59, "negative": 8862, "positive": 378, "shortDate": "7/29"}, {"day": "2020-07-30", "inconclusive": 48, "negative": 9748, "positive": 342, "shortDate": "7/30"}, {"day": "2020-07-31", "inconclusive": 75, "negative": 10475, "positive": 279, "shortDate": "7/31"}, {"day": "2020-08-01", "inconclusive": 61, "negative": 9418, "positive": 309, "shortDate": "8/1"}, {"day": "2020-08-02", "inconclusive": 40, "negative": 6341, "positive": 219, "shortDate": "8/2"}, {"day": "2020-08-03", "inconclusive": 30, "negative": 4754, "positive": 286, "shortDate": "8/3"}, {"day": "2020-08-04", "inconclusive": 36, "negative": 12416, "positive": 305, "shortDate": "8/4"}, {"day": "2020-08-05", "inconclusive": 28, "negative": 8953, "positive": 164, "shortDate": "8/5"}, {"day": "2020-08-06", "inconclusive": 47, "negative": 12706, "positive": 255, "shortDate": "8/6"}, {"day": "2020-08-07", "inconclusive": 51, "negative": 11496, "positive": 265, "shortDate": "8/7"}, {"day": "2020-08-08", "inconclusive": 33, "negative": 9189, "positive": 177, "shortDate": "8/8"}, {"day": "2020-08-09", "inconclusive": 21, "negative": 7101, "positive": 248, "shortDate": "8/9"}, {"day": "2020-08-10", "inconclusive": 23, "negative": 4039, "positive": 85, "shortDate": "8/10"}, {"day": "2020-08-11", "inconclusive": 28, "negative": 9402, "positive": 185, "shortDate": "8/11"}, {"day": "2020-08-12", "inconclusive": 64, "negative": 16846, "positive": 126, "shortDate": "8/12"}, {"day": "2020-08-13", "inconclusive": 35, "negative": 10178, "positive": 107, "shortDate": "8/13"}, {"day": "2020-08-14", "inconclusive": 73, "negative": 15093, "positive": 176, "shortDate": "8/14"}, {"day": "2020-08-15", "inconclusive": 57, "negative": 14562, "positive": 145, "shortDate": "8/15"}, {"day": "2020-08-16", "inconclusive": 35, "negative": 8666, "positive": 58, "shortDate": "8/16"}, {"day": "2020-08-17", "inconclusive": 18, "negative": 7011, "positive": 68, "shortDate": "8/17"}, {"day": "2020-08-18", "inconclusive": 145, "negative": 27079, "positive": 147, "shortDate": "8/18"}, {"day": "2020-08-19", "inconclusive": 140, "negative": 32078, "positive": 136, "shortDate": "8/19"}, {"day": "2020-08-20", "inconclusive": 110, "negative": 23911, "positive": 236, "shortDate": "8/20"}, {"day": "2020-08-21", "inconclusive": 123, "negative": 29823, "positive": 182, "shortDate": "8/21"}, {"day": "2020-08-22", "inconclusive": 122, "negative": 20754, "positive": 133, "shortDate": "8/22"}, {"day": "2020-08-23", "inconclusive": 55, "negative": 17410, "positive": 76, "shortDate": "8/23"}, {"day": "2020-08-24", "inconclusive": 57, "negative": 18126, "positive": 50, "shortDate": "8/24"}, {"day": "2020-08-25", "inconclusive": 119, "negative": 30018, "positive": 154, "shortDate": "8/25"}, {"day": "2020-08-26", "inconclusive": 170, "negative": 37588, "positive": 131, "shortDate": "8/26"}, {"day": "2020-08-27", "inconclusive": 278, "negative": 41063, "positive": 201, "shortDate": "8/27"}, {"day": "2020-08-28", "inconclusive": 213, "negative": 43552, "positive": 163, "shortDate": "8/28"}, {"day": "2020-08-29", "inconclusive": 116, "negative": 37686, "positive": 95, "shortDate": "8/29"}, {"day": "2020-08-30", "inconclusive": 134, "negative": 44214, "positive": 85, "shortDate": "8/30"}, {"day": "2020-08-31", "inconclusive": 104, "negative": 34448, "positive": 65, "shortDate": "8/31"}, {"day": "2020-09-01", "inconclusive": 227, "negative": 58146, "positive": 217, "shortDate": "9/1"}, {"day": "2020-09-02", "inconclusive": 244, "negative": 61110, "positive": 178, "shortDate": "9/2"}, {"day": "2020-09-03", "inconclusive": 283, "negative": 60614, "positive": 186, "shortDate": "9/3"}, {"day": "2020-09-04", "inconclusive": 310, "negative": 53378, "positive": 193, "shortDate": "9/4"}, {"day": "2020-09-05", "inconclusive": 208, "negative": 57795, "positive": 190, "shortDate": "9/5"}, {"day": "2020-09-06", "inconclusive": 68, "negative": 19680, "positive": 61, "shortDate": "9/6"}, {"day": "2020-09-07", "inconclusive": 67, "negative": 22574, "positive": 62, "shortDate": "9/7"}, {"day": "2020-09-08", "inconclusive": 120, "negative": 42779, "positive": 114, "shortDate": "9/8"}, {"day": "2020-09-09", "inconclusive": 223, "negative": 66156, "positive": 283, "shortDate": "9/9"}, {"day": "2020-09-10", "inconclusive": 203, "negative": 66767, "positive": 276, "shortDate": "9/10"}, {"day": "2020-09-11", "inconclusive": 244, "negative": 61451, "positive": 296, "shortDate": "9/11"}, {"day": "2020-09-12", "inconclusive": 105, "negative": 42077, "positive": 190, "shortDate": "9/12"}, {"day": "2020-09-13", "inconclusive": 96, "negative": 19364, "positive": 53, "shortDate": "9/13"}, {"day": "2020-09-14", "inconclusive": 73, "negative": 24059, "positive": 73, "shortDate": "9/14"}, {"day": "2020-09-15", "inconclusive": 494, "negative": 62094, "positive": 271, "shortDate": "9/15"}, {"day": "2020-09-16", "inconclusive": 314, "negative": 65072, "positive": 242, "shortDate": "9/16"}, {"day": "2020-09-17", "inconclusive": 345, "negative": 64793, "positive": 333, "shortDate": "9/17"}, {"day": "2020-09-18", "inconclusive": 349, "negative": 61326, "positive": 224, "shortDate": "9/18"}, {"day": "2020-09-19", "inconclusive": 360, "negative": 61366, "positive": 254, "shortDate": "9/19"}, {"day": "2020-09-20", "inconclusive": 43, "negative": 9331, "positive": 62, "shortDate": "9/20"}, {"day": "2020-09-21", "inconclusive": 140, "negative": 21809, "positive": 45, "shortDate": "9/21"}, {"day": "2020-09-22", "inconclusive": 283, "negative": 65468, "positive": 206, "shortDate": "9/22"}, {"day": "2020-09-23", "inconclusive": 373, "negative": 65574, "positive": 294, "shortDate": "9/23"}, {"day": "2020-09-24", "inconclusive": 350, "negative": 71728, "positive": 409, "shortDate": "9/24"}, {"day": "2020-09-25", "inconclusive": 269, "negative": 61528, "positive": 307, "shortDate": "9/25"}, {"day": "2020-09-26", "inconclusive": 257, "negative": 61936, "positive": 342, "shortDate": "9/26"}, {"day": "2020-09-27", "inconclusive": 33, "negative": 13283, "positive": 133, "shortDate": "9/27"}, {"day": "2020-09-28", "inconclusive": 123, "negative": 24688, "positive": 109, "shortDate": "9/28"}, {"day": "2020-09-29", "inconclusive": 377, "negative": 69928, "positive": 437, "shortDate": "9/29"}, {"day": "2020-09-30", "inconclusive": 407, "negative": 72250, "positive": 354, "shortDate": "9/30"}, {"day": "2020-10-01", "inconclusive": 427, "negative": 70143, "positive": 438, "shortDate": "10/1"}, {"day": "2020-10-02", "inconclusive": 461, "negative": 68706, "positive": 435, "shortDate": "10/2"}, {"day": "2020-10-03", "inconclusive": 280, "negative": 53183, "positive": 283, "shortDate": "10/3"}, {"day": "2020-10-04", "inconclusive": 44, "negative": 15505, "positive": 373, "shortDate": "10/4"}, {"day": "2020-10-05", "inconclusive": 54, "negative": 25019, "positive": 95, "shortDate": "10/5"}, {"day": "2020-10-06", "inconclusive": 294, "negative": 68711, "positive": 349, "shortDate": "10/6"}, {"day": "2020-10-07", "inconclusive": 294, "negative": 70963, "positive": 338, "shortDate": "10/7"}, {"day": "2020-10-08", "inconclusive": 330, "negative": 70388, "positive": 395, "shortDate": "10/8"}, {"day": "2020-10-09", "inconclusive": 340, "negative": 71647, "positive": 477, "shortDate": "10/9"}, {"day": "2020-10-10", "inconclusive": 236, "negative": 68916, "positive": 430, "shortDate": "10/10"}, {"day": "2020-10-11", "inconclusive": 50, "negative": 13240, "positive": 133, "shortDate": "10/11"}, {"day": "2020-10-12", "inconclusive": 81, "negative": 22018, "positive": 158, "shortDate": "10/12"}, {"day": "2020-10-13", "inconclusive": 205, "negative": 60847, "positive": 341, "shortDate": "10/13"}, {"day": "2020-10-14", "inconclusive": 206, "negative": 66696, "positive": 315, "shortDate": "10/14"}, {"day": "2020-10-15", "inconclusive": 268, "negative": 67406, "positive": 565, "shortDate": "10/15"}, {"day": "2020-10-16", "inconclusive": 286, "negative": 80851, "positive": 567, "shortDate": "10/16"}, {"day": "2020-10-17", "inconclusive": 346, "negative": 71310, "positive": 426, "shortDate": "10/17"}, {"day": "2020-10-18", "inconclusive": 46, "negative": 15023, "positive": 183, "shortDate": "10/18"}, {"day": "2020-10-19", "inconclusive": 64, "negative": 26145, "positive": 200, "shortDate": "10/19"}, {"day": "2020-10-20", "inconclusive": 218, "negative": 74876, "positive": 551, "shortDate": "10/20"}, {"day": "2020-10-21", "inconclusive": 178, "negative": 76882, "positive": 510, "shortDate": "10/21"}, {"day": "2020-10-22", "inconclusive": 230, "negative": 80570, "positive": 726, "shortDate": "10/22"}, {"day": "2020-10-23", "inconclusive": 267, "negative": 81252, "positive": 791, "shortDate": "10/23"}, {"day": "2020-10-24", "inconclusive": 179, "negative": 52318, "positive": 654, "shortDate": "10/24"}, {"day": "2020-10-25", "inconclusive": 41, "negative": 12254, "positive": 207, "shortDate": "10/25"}, {"day": "2020-10-26", "inconclusive": 77, "negative": 28166, "positive": 225, "shortDate": "10/26"}, {"day": "2020-10-27", "inconclusive": 228, "negative": 79649, "positive": 745, "shortDate": "10/27"}, {"day": "2020-10-28", "inconclusive": 263, "negative": 76639, "positive": 634, "shortDate": "10/28"}, {"day": "2020-10-29", "inconclusive": 244, "negative": 73484, "positive": 857, "shortDate": "10/29"}, {"day": "2020-10-30", "inconclusive": 215, "negative": 70333, "positive": 660, "shortDate": "10/30"}, {"day": "2020-10-31", "inconclusive": 207, "negative": 60056, "positive": 510, "shortDate": "10/31"}, {"day": "2020-11-01", "inconclusive": 44, "negative": 17427, "positive": 362, "shortDate": "11/1"}, {"day": "2020-11-02", "inconclusive": 73, "negative": 26854, "positive": 237, "shortDate": "11/2"}, {"day": "2020-11-03", "inconclusive": 187, "negative": 70586, "positive": 932, "shortDate": "11/3"}, {"day": "2020-11-04", "inconclusive": 245, "negative": 84715, "positive": 998, "shortDate": "11/4"}, {"day": "2020-11-05", "inconclusive": 280, "negative": 83092, "positive": 1173, "shortDate": "11/5"}, {"day": "2020-11-06", "inconclusive": 268, "negative": 79042, "positive": 1352, "shortDate": "11/6"}, {"day": "2020-11-07", "inconclusive": 197, "negative": 74741, "positive": 1257, "shortDate": "11/7"}, {"day": "2020-11-08", "inconclusive": 73, "negative": 12077, "positive": 439, "shortDate": "11/8"}, {"day": "2020-11-09", "inconclusive": 88, "negative": 31538, "positive": 471, "shortDate": "11/9"}, {"day": "2020-11-10", "inconclusive": 204, "negative": 65003, "positive": 1398, "shortDate": "11/10"}, {"day": "2020-11-11", "inconclusive": 318, "negative": 97102, "positive": 1506, "shortDate": "11/11"}, {"day": "2020-11-12", "inconclusive": 198, "negative": 78626, "positive": 1509, "shortDate": "11/12"}, {"day": "2020-11-13", "inconclusive": 244, "negative": 86437, "positive": 1657, "shortDate": "11/13"}, {"day": "2020-11-14", "inconclusive": 175, "negative": 70156, "positive": 1392, "shortDate": "11/14"}, {"day": "2020-11-15", "inconclusive": 96, "negative": 19667, "positive": 839, "shortDate": "11/15"}, {"day": "2020-11-16", "inconclusive": 92, "negative": 31309, "positive": 702, "shortDate": "11/16"}, {"day": "2020-11-17", "inconclusive": 249, "negative": 88116, "positive": 1651, "shortDate": "11/17"}, {"day": "2020-11-18", "inconclusive": 207, "negative": 81636, "positive": 1472, "shortDate": "11/18"}, {"day": "2020-11-19", "inconclusive": 103, "negative": 24665, "positive": 542, "shortDate": "11/19"}, {"day": "2020-11-20", "inconclusive": 280, "negative": 103485, "positive": 1813, "shortDate": "11/20"}, {"day": "2020-11-21", "inconclusive": 368, "negative": 102406, "positive": 1725, "shortDate": "11/21"}, {"day": "2020-11-22", "inconclusive": 100, "negative": 36662, "positive": 759, "shortDate": "11/22"}, {"day": "2020-11-23", "inconclusive": 140, "negative": 51496, "positive": 1197, "shortDate": "11/23"}, {"day": "2020-11-24", "inconclusive": 367, "negative": 75193, "positive": 1299, "shortDate": "11/24"}, {"day": "2020-11-25", "inconclusive": 239, "negative": 88736, "positive": 1977, "shortDate": "11/25"}, {"day": "2020-11-26", "inconclusive": 143, "negative": 44703, "positive": 1157, "shortDate": "11/26"}, {"day": "2020-11-27", "inconclusive": 87, "negative": 13145, "positive": 544, "shortDate": "11/27"}, {"day": "2020-11-28", "inconclusive": 125, "negative": 27868, "positive": 1268, "shortDate": "11/28"}, {"day": "2020-11-29", "inconclusive": 83, "negative": 21157, "positive": 1276, "shortDate": "11/29"}, {"day": "2020-11-30", "inconclusive": 98, "negative": 31524, "positive": 825, "shortDate": "11/30"}, {"day": "2020-12-01", "inconclusive": 304, "negative": 80572, "positive": 2328, "shortDate": "12/1"}, {"day": "2020-12-02", "inconclusive": 271, "negative": 70376, "positive": 3368, "shortDate": "12/2"}, {"day": "2020-12-03", "inconclusive": 239, "negative": 55703, "positive": 2546, "shortDate": "12/3"}, {"day": "2020-12-04", "inconclusive": 303, "negative": 70354, "positive": 3121, "shortDate": "12/4"}, {"day": "2020-12-05", "inconclusive": 205, "negative": 51384, "positive": 2437, "shortDate": "12/5"}, {"day": "2020-12-06", "inconclusive": 57, "negative": 16411, "positive": 731, "shortDate": "12/6"}, {"day": "2020-12-07", "inconclusive": 160, "negative": 28266, "positive": 1102, "shortDate": "12/7"}, {"day": "2020-12-08", "inconclusive": 56, "negative": 14548, "positive": 699, "shortDate": "12/8"}];
  let currentTime = new Date(new Date().toLocaleDateString());
  configFigureMenu();
  setChartGlobalConfig();
  render("3M")
  
  
  function configFigureMenu(){
    let tScale = null;
    $(".btn-group > button.btn").on("click", function() {
      
      $(".btn-group > button.btn").removeClass("active");
      $(this).addClass("active");

      tScale = this.innerHTML;
      console.log("time scale is " + tScale);
      render(tScale);
    })
  }
  function setChartGlobalConfig() {
    Highcharts.setOptions({
      credits: {
        enabled: false
      },
      lang: {
        thousandsSep: ','
      },
      chart: {
        marginRight: 20,
        time: {
            timezone: 'America/New_York'
        },
      },
      xAxis: {
        type: 'datetime',
        crosshair: true,
        startOnTick: true,
        tickInterval: 7 * 24 * 3600 * 1000,
        labels: {
          rotation: 60,
          formatter() {
            return Highcharts.dateFormat('%b-%e', this.value)
          }
        },
        min: undefined
      },
      responsive: {
        rules: [{
          condition: {
            maxWidth: 700,
          },
          chartOptions: {
            yAxis: {
              minorTicks: true,
            }
          }
        }]
      }
    })
  }
  function render(tScale) {
    let interval = null;
    switch(tScale){
      case "1W": 
        interval = 6.048*1e8;
        break;
      case "1M":
        interval = 2.628*1e9;
        break;
      case "3M":
        interval = 7.884*1e9;
        break;
      case "6M":
        interval = 1.577*1e10;
        break;
      default:
        interval = undefined;
    }
    let tMin = interval===undefined?undefined:currentTime.getTime() - interval;
    let xAxis = {
      type: 'datetime',
      crosshair: true,
      tickInterval: tScale=="1W"?24*3600*1000:7*24*3600*1000,
      startOnTick: false,
      labels: {
        rotation: 60,
        formatter() {
          return Highcharts.dateFormat('%b-%e', this.value)
        }
      },
      min: tMin
    };
    plotCumulativeTests(xAxis);
    plotDailyVolume(xAxis);
    plotDailyPositiveRate(xAxis);
  }
  function plotCumulativeTests(xAxis) {
    const cumulativeTotals = []
    data.reduce(function(a, x, i) { 
      let v = a + x.positive + x.negative + x.inconclusive;
      let time = new Date(x.day.replace(/-/g, "/")).getTime();
      cumulativeTotals[i] = [time, v];
      return v;
    }, 0);
    const cumulativePositives = [];
    
    data.reduce(function(a, x, i) { 
      let v = a + x.positive;
      let time = new Date(x.day.replace(/-/g, "/")).getTime();
      cumulativePositives[i] = [time, v];
      return v 
    }, 0)
    Highcharts.chart('chart-1', {
      chart: {
        type: 'spline',
        height: '350px',        
      },
      time: {
          useUTC: false
      },
      legend: {
        floating: true,
        align: 'left',
        verticalAlign: 'top',
        layout: 'vertical',
        x: 60,
        y: 30,
        backgroundColor: '#ffffff'
      },
      title: {
        text: 'Cumulative Volume'
      },
      plotOptions: {
        series: {
          dataLabels: {
            enabled: false,
            y: -5,
          },
        },
      },
      tooltip: {
        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
        pointFormat: '<tr><td style="color:{series.color}">{series.name}: </td><td style="padding-left: 5px"><b>{point.y:,.0f}</b></td></tr>',
        footerFormat: '</table>',
        shared: true,
        useHTML: true
      },
      xAxis: xAxis,
      yAxis: {
        tickAmount: 5,
        min: 0,
        title: {
          enabled: false,
        },
      },
      
      series: [
        {
          name: 'Cumulative Tests Completed',
          data: cumulativeTotals,
          color: "#439798", //"#00AA00AA",
        }, {
          name: 'Cumulative Positives',
          data: cumulativePositives,
          color: "#e18b50", //"#BB0000AA",
        }]
    });
  }
  function plotDailyVolume(xAxis) {
    Highcharts.chart('chart-2', {
      global: {
        useUTC: false
      },
      chart: {
        height: '350px',
      },
      legend: {
        floating: true,
        align: 'left',
        verticalAlign: 'top',
        layout: 'vertical',
        x: 60,
        y: 30,
        backgroundColor: '#ffffff'
      },
      title: {
        text: 'Daily Volume'
      },
      plotOptions: {
        column: {
          stacking: 'normal',
          pointPadding: 0.2,
          borderColor: '#439798',
          borderWidth: 1,
        },
      },
      tooltip: {
        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
        pointFormat: '<tr><td style="color:{series.color}">{series.name}: </td><td style="padding-left: 5px;min-width:60px;"><b>{point.y:,.0f}</b></td></tr>',
        footerFormat: '</table>',
        shared: true,
        useHTML: true
      },
      xAxis: xAxis,
      yAxis: {
        reversedStacks: false,
        min: 0,
        tickAmount: 5,
        title: {
          enabled: false,
        }
      },
      
      series: [
        {
          name: 'Tests Completed',
          type: 'column',
          data: data.map(function(x) { 
            const time = new Date(x.day.replace(/,/g, '/')).getTime();
            return [time, x.positive + x.negative + x.inconclusive];
          }),
          color: "#439798", //"#00AA00AA",
          dataLabels: {
            enabled: false,
          },
        },
      ]
    }, function(chart) {
      var series = chart.series;
      $.each(series, function(i, ser) {
        $(ser.legendSymbol.element).attr('stroke-width','1');
        $(ser.legendSymbol.element).attr('stroke','#439798');
      });
    });
  }
  function plotDailyPositiveRate(xAxis) {
    // calculate the 7-day rolling average
    const dataReverse = [...data].reverse();
    let rollingAve = []; // assumption: the array, data, is sorted by date and without missing days
    dataReverse.forEach( function(x, i) {
      let j = i + 7;
      if (j<dataReverse.length){
        let week = dataReverse.slice(i, j);
        let totalPositive = week.reduce(function(a, d){
          a = a + d.positive;
          return a;
        }, 0);
        let totalTest = week.reduce(function(a, d){
          a = a + d.inconclusive+d.negative+d.positive;
          return a;
        }, 0);
        rollingAve.unshift({
          day: x.day,
          positive: totalPositive,
          total: totalTest
        })
      }
    });
    
    // report the most recent rolling ave in the left-side report card
    const mostRecent = rollingAve[rollingAve.length-1]; 
    $("#rolling-ave").text(`${(100 * (mostRecent.positive/mostRecent.total)).toFixed(2)}%`);

    // rendering
    Highcharts.chart('chart-3', {
      chart: {
        height: '300px',
      },
      legend: {
        floating: true,
        align: 'right',
        verticalAlign: 'top',
        layout: 'vertical',
        x: 0,
        y: 70,
        backgroundColor: '#ffffff'
      },
      title: {
        text: 'Daily Positive Rate'
      },
      plotOptions: {
        column: {
          borderWidth: 0,
        },
      },
      xAxis: xAxis,
      yAxis: [
        {
          endOnTick: false,
          min: 0,
          softMax: 5,
          tickAmount: 5,
          // tickInterval: tickInterval,
          // minorTickInterval: 5,
          // minorTicks: false,
          title: {
            enabled: false,
          },
          labels: {
            format: "{value} %",
          }
        }
      ],
      tooltip: {        
        valueDecimals: 2,
        valueSuffix: '%',
        headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
        pointFormat: '<tr><td style="color:{series.color}">{series.name}: </td><td style="padding-left: 5px;min-width:60px;"><b>{point.y}</b></td></tr>',
        footerFormat: '</table>',
        shared: true,
        useHTML: true
      },	   
      series: [
        {
          name: '% Positive (7-day Rolling Average)',
          type: 'line',
          data: rollingAve.map(function(x) { 
            const time = new Date(x.day.replace(/,/g, '/')).getTime();
            return [time, 100 * x.positive/x.total] 
          }),            
          color: "#aaaaaa",
          lineWidth: 2
        },
        {
          name: '% Positive (Daily)',
          type: 'line',
          data: data.map(function(x) { 
            const time = new Date(x.day.replace(/,/g, '/')).getTime();
            return [time, 100 * x.positive/(x.positive + x.negative + x.inconclusive)] 
          }),            
          color: "#e18b50", //"#BB0000AA",
          lineWidth: 1
        }
      ]
    });
  }
</script>
 </html>